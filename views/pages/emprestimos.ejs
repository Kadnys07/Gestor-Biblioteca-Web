<!-- Cabeçalho da página -->
<div class="flex justify-between items-center mb-6">
  <h1 class="text-3xl font-bold text-gray-800">Controle de Empréstimos</h1>
  <a href="/emprestimos/novo" class="flex items-center px-4 py-2 font-semibold text-white bg-yellow-700 rounded-lg hover:bg-yellow-800 transition-colors shadow-sm hover:shadow-md">
    <i class="ph-bold ph-plus mr-2"></i> Novo Empréstimo
  </a>
</div>

<!-- Filtros e Busca -->
<div class="mb-4 flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4">
  <input type="search" id="emprestimo-search" placeholder="Pesquisar por livro ou leitor..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500 transition">
  <select id="emprestimo-status-filter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500 transition">
    <option value="todos">Todos</option>
    <option value="pendente">Pendentes</option>
    <option value="devolvido">Devolvidos</option>
  </select>
</div>

<!-- Container da Tabela com Responsividade -->
<div class="bg-white rounded-xl shadow-lg overflow-hidden">
  <div class="overflow-x-auto">
    <table class="w-full" id="tabela-emprestimos">
      <!-- Cabeçalho da Tabela -->
      <thead class="bg-gray-50">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Livro</th>
          <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Leitor</th>
          <th class="px-6 py-3 text-center text-xs font-semibold text-gray-500 uppercase tracking-wider">Empréstimo</th>
          <th class="px-6 py-3 text-center text-xs font-semibold text-gray-500 uppercase tracking-wider">Devolução</th>
          <th class="px-6 py-3 text-center text-xs font-semibold text-gray-500 uppercase tracking-wider">Status</th>
          <th class="px-6 py-3 text-center text-xs font-semibold text-gray-500 uppercase tracking-wider">Ações</th>
        </tr>
      </thead>
      <!-- Corpo da Tabela -->
      <tbody class="divide-y divide-gray-200">
        <% emprestimos.forEach(emp => { %>
          <tr class="hover:bg-gray-50 transition-colors"
              data-status="<%= emp.status %>"
              data-search="<%= emp.livro %> <%= emp.leitor %>">
            <td class="px-6 py-4 whitespace-nowrap align-middle"><%= emp.livro %></td>
            <td class="px-6 py-4 whitespace-nowrap align-middle"><%= emp.leitor %></td>
            <td class="px-6 py-4 whitespace-nowrap text-center align-middle"><%= formatarData(emp.dataInicio) %></td>
            <td class="px-6 py-4 whitespace-nowrap text-center align-middle"><%= formatarData(emp.devolucao) %></td>
            <td class="px-6 py-4 whitespace-nowrap text-center align-middle">
              <span class="px-3 py-1 text-xs font-semibold leading-5 rounded-full <%= emp.status === 'pendente' ? 'text-yellow-800 bg-yellow-100' : 'text-green-800 bg-green-100' %>">
                <%= emp.status.charAt(0).toUpperCase() + emp.status.slice(1) %>
              </span>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-center align-middle">
              <i class="ph ph-pencil-simple text-xl cursor-pointer text-blue-600 hover:text-blue-800 transition-colors"
                 title="Editar Empréstimo"
                 onclick="abrirModalEmprestimo(<%= JSON.stringify(emp) %>, '<%= emp.id %>')"></i>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</div>

<%- include("../modals/edit_emprestimo") %>

